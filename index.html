<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resonance RPG -Simple-</title>
    <style>
        :root { --bg: #0d0d0f; --card: #1a1a22; --owen: #9b59b6; --cain: #f1c40f; --text: #dcdde1; }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; padding: 10px; line-height: 1.4; }
        .mission { border: 1px solid #e74c3c; color: #ff7675; text-align: center; padding: 8px; margin-bottom: 10px; font-weight: bold; font-size: 0.9rem; }
        .char-card { background: var(--card); padding: 12px; border-radius: 5px; margin-bottom: 8px; border-left: 4px solid #444; }
        .status-line { font-size: 0.9rem; display: flex; justify-content: space-between; margin-top: 5px; }
        #log { background: #000; height: 180px; overflow-y: auto; padding: 10px; font-size: 0.85rem; border: 1px solid #333; margin-bottom: 10px; }
        .resource-bar { font-size: 0.75rem; background: #25252b; padding: 5px 10px; display: flex; justify-content: space-around; margin-bottom: 10px; }
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        button { background: #2d3436; color: #fff; border: 1px solid #555; padding: 15px 5px; border-radius: 5px; cursor: pointer; font-size: 0.8rem; }
        button:disabled { opacity: 0.2; }
    </style>
</head>
<body>

<div class="mission" id="m-info">ボスまで: 10km</div>

<div class="char-card" style="border-color: var(--owen);">
    <div style="color:var(--owen); font-weight:bold;">オーエン</div>
    <div class="status-line"><span>HP: <b id="o-hp">80</b> / 80</span> <span>MP: <b id="o-mp">120</b> / 120</span></div>
</div>

<div class="char-card" style="border-color: var(--cain);">
    <div style="color:var(--cain); font-weight:bold;">カイン</div>
    <div class="status-line"><span>HP: <b id="c-hp">120</b> / 120</span> <span>MP: <b id="c-mp">50</b> / 50</span></div>
</div>

<div class="resource-bar">
    <span>備蓄素材: <b id="t-mat">0</b></span>
    <span>今回獲得: <b id="s-mat">0</b></span>
    <span>甘味: <b id="sw">3</b></span>
</div>

<div id="log"></div>

<div class="controls">
    <button onclick="cmd('safe')">慎重に進む<br>(距離-1/MP少)</button>
    <button onclick="cmd('bold')">大胆に進む<br>(距離-2/MP多)</button>
    <button onclick="cmd('eat')">甘味を与える<br>(オーエン回復)</button>
    <button onclick="cmd('inn')">宿屋に戻る<br>(無料/全回復)</button>
</div>

<script>
    const st = { o:{h:80,mh:80,m:120,mm:120}, c:{h:120,mh:120,m:50,mm:50}, t:0, s:0, sw:3, dist:10, boss:false };
    
    function addLog(m, color="#dcdde1") {
        const l = document.getElementById('log');
        l.innerHTML += `<div style="color:${color}; margin-bottom:4px;">${m}</div>`;
        l.scrollTop = l.scrollHeight;
    }

    function update() {
        document.getElementById('o-hp').innerText = st.o.h;
        document.getElementById('o-mp').innerText = st.o.m;
        document.getElementById('c-hp').innerText = st.c.h;
        document.getElementById('c-mp').innerText = st.c.m;
        document.getElementById('t-mat').innerText = st.t;
        document.getElementById('s-mat').innerText = st.s;
        document.getElementById('sw').innerText = st.sw;
        document.getElementById('m-info').innerText = st.boss ? "⚠ 厄災の核 と交戦中" : `ボスまで: 残り ${st.dist}km`;
    }

    function cmd(type) {
        if(st.c.h <= 0 && type !== 'inn') return;

        if(type==='safe' || type==='bold') {
            const isB = type==='bold';
            st.dist = Math.max(0, st.dist - (isB?2:1));
            st.o.m = Math.max(0, st.o.m - (isB?25:10));
            
            addLog(isB ? "オーエンが苛立ちを魔力に変え、カインを引き連れて進軍する。" : "カインが周囲の気配を慎重に探り、足場を確保する。");
            
            if(st.dist === 0 && !st.boss) {
                st.boss = true;
                addLog("不気味な魔力の高まり。前方に『厄災の核』が出現した。","#ff7675");
            }

            // 戦闘
            const rate = st.boss ? 1.0 : (isB ? 0.7 : 0.2);
            if(Math.random() < rate) {
                let dmg = isB ? 25 : 12;
                if(st.boss) dmg = 50;
                st.c.h -= dmg;
                addLog(`敵の激しい一撃。カインがオーエンの前に立ち、盾となって衝撃を受けた。`,"#ff7675");
                
                if(st.c.h <= 0) {
                    st.c.h = 0;
                    addLog("カインが力尽き膝をつく。オーエンは舌打ちと共に彼を担ぎ、撤退を開始した。","#ff7675");
                    addLog(`探索失敗。今回獲得した素材 ${st.s} 個をすべて喪失。`,"#7f8c8d");
                    st.s = 0; st.sw = 0; st.dist = 10; st.boss = false;
                } else if(st.boss) {
                    addLog("オーエンの魔術が核を貫き、カインの剣がトドメを刺した。","#f1c40f");
                    st.boss = false; st.dist = 15; st.s += 10;
                } else {
                    const gain = isB ? 3 : 1;
                    st.s += gain;
                    addLog(`敵を排除し、素材を${gain}個回収。`);
                }
            }
        } else if(type==='eat') {
            if(st.sw > 0) {
                st.sw--; st.o.m = st.o.mm;
                addLog("オーエンは菓子を不機嫌そうに奪い取り、魔力を回復させた。");
            }
        } else if(type==='inn') {
            st.t += st.s; st.s = 0; st.sw = 3;
            st.o.h=st.o.mh; st.o.m=st.o.mm; st.c.h=st.c.mh; st.c.m=st.c.mm;
            st.boss = false;
            addLog("宿屋の安息。カインは装備を磨き、オーエンは窓の外を眺めて誰とも目を合わせない。");
            addLog("カインが給仕に親しく話しかけられている。オーエンは無言でカインの靴を魔法で床に縫い付けた。","#7f8c8d");
        }
        update();
    }
    update();
</script>
</body>
</html>